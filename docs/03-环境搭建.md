# ç¯å¢ƒæ­å»º - è¯¦ç»†çš„ç¯å¢ƒé…ç½®æŒ‡å—

åœ¨å¼€å§‹ä½¿ç”¨ PandaFactor ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ­å»ºå¥½è¿è¡Œç¯å¢ƒã€‚åˆ«æ‹…å¿ƒï¼Œæˆ‘ä»¬ä¼šä¸€æ­¥æ­¥æŒ‡å¯¼ä½ å®Œæˆã€‚

## ğŸ“‹ å‰ç½®è¦æ±‚

åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ çš„ç”µè„‘ä¸Šå·²ç»å®‰è£…äº†ï¼š

### å¿…éœ€è½¯ä»¶

1. **Python 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬**

    - æ£€æŸ¥æ–¹æ³•ï¼šæ‰“å¼€ç»ˆç«¯ï¼ˆWindows æ˜¯ CMD æˆ– PowerShellï¼ŒMac/Linux æ˜¯ Terminalï¼‰
    - è¾“å…¥ï¼š`python --version` æˆ– `python3 --version`
    - åº”è¯¥æ˜¾ç¤ºç±»ä¼¼ï¼š`Python 3.8.x` æˆ–æ›´é«˜

2. **MongoDB æ•°æ®åº“**

    - è¿™æ˜¯å­˜å‚¨æ•°æ®çš„åœ°æ–¹ï¼Œå°±åƒä»“åº“
    - ä¸‹è½½åœ°å€ï¼šhttps://www.mongodb.com/try/download/community
    - æˆ–è€…ä½¿ç”¨äº‘æ•°æ®åº“ï¼ˆå¦‚ MongoDB Atlasï¼‰

3. **Git**ï¼ˆå¯é€‰ï¼Œå¦‚æœä» GitHub ä¸‹è½½ä»£ç ï¼‰
    - ä¸‹è½½åœ°å€ï¼šhttps://git-scm.com/downloads

### æ¨èè½¯ä»¶

-   **ä»£ç ç¼–è¾‘å™¨**ï¼šVS Codeã€PyCharm æˆ– Cursor
-   **æ•°æ®åº“ç®¡ç†å·¥å…·**ï¼šMongoDB Compassï¼ˆå¯è§†åŒ–æŸ¥çœ‹æ•°æ®ï¼‰

## ğŸš€ å®‰è£…æ­¥éª¤

### æ–¹å¼ä¸€ï¼šä¸ªäººç”¨æˆ·ï¼ˆå¿«é€Ÿå¼€å§‹ï¼‰

å¦‚æœä½ åªæ˜¯æƒ³å¿«é€Ÿä½“éªŒï¼Œå¯ä»¥ä½¿ç”¨æˆ‘ä»¬å‡†å¤‡å¥½çš„æ•°æ®åº“ï¼š

1. **ä¸‹è½½åˆå§‹æ•°æ®åº“**

    - è”ç³»å°åŠ©ç†è·å–æ•°æ®åº“æ–‡ä»¶
    - æ–‡ä»¶è¾ƒå¤§ï¼Œéœ€è¦ä¸€äº›æ—¶é—´ä¸‹è½½

2. **è§£å‹æ•°æ®åº“**

    - è§£å‹åˆ°ä»»æ„ç›®å½•ï¼ˆå¦‚ `D:\panda_db`ï¼‰

3. **å¯åŠ¨æ•°æ®åº“**

    - è¿›å…¥è§£å‹åçš„ `bin` ç›®å½•
    - åŒå‡»è¿è¡Œ `db_start.bat`ï¼ˆWindowsï¼‰æˆ– `db_start.sh`ï¼ˆMac/Linuxï¼‰
    - çœ‹åˆ° "MongoDB started" è¡¨ç¤ºå¯åŠ¨æˆåŠŸ

4. **å®‰è£… Python ä¾èµ–**

    ```bash
    pip install -r requirements.txt
    ```

5. **å®Œæˆï¼** ç°åœ¨å¯ä»¥å¼€å§‹ä½¿ç”¨äº†

### æ–¹å¼äºŒï¼šå›¢é˜Ÿç”¨æˆ·ï¼ˆå®Œæ•´éƒ¨ç½²ï¼‰

å¦‚æœä½ éœ€è¦å®Œæ•´éƒ¨ç½²ä¾›å›¢é˜Ÿä½¿ç”¨ï¼š

#### æ­¥éª¤ 1ï¼šå®‰è£… MongoDB

**Windowsï¼š**

1. ä¸‹è½½ MongoDB Community Server
2. è¿è¡Œå®‰è£…ç¨‹åºï¼Œé€‰æ‹© "Complete" å®‰è£…
3. å®‰è£…è¿‡ç¨‹ä¸­é€‰æ‹© "Install MongoDB as a Service"
4. è®°ä½å®‰è£…è·¯å¾„ï¼ˆé»˜è®¤æ˜¯ `C:\Program Files\MongoDB\`ï¼‰

**Macï¼š**

```bash
# ä½¿ç”¨ Homebrew å®‰è£…
brew tap mongodb/brew
brew install mongodb-community
```

**Linuxï¼š**

```bash
# Ubuntu/Debian
sudo apt-get install mongodb

# CentOS/RHEL
sudo yum install mongodb-server
```

**éªŒè¯å®‰è£…ï¼š**

```bash
mongod --version
```

#### æ­¥éª¤ 2ï¼šå¯åŠ¨ MongoDB

**Windowsï¼š**

-   MongoDB ä¼šä½œä¸ºæœåŠ¡è‡ªåŠ¨å¯åŠ¨
-   æˆ–è€…æ‰‹åŠ¨å¯åŠ¨ï¼š`net start MongoDB`

**Mac/Linuxï¼š**

```bash
# å¯åŠ¨ MongoDB
brew services start mongodb-community  # Mac
# æˆ–
sudo systemctl start mongod  # Linux
```

**éªŒè¯è¿è¡Œï¼š**

```bash
# è¿æ¥ MongoDB
mongo
# æˆ–
mongosh
```

å¦‚æœçœ‹åˆ° `>` æç¤ºç¬¦ï¼Œè¯´æ˜è¿æ¥æˆåŠŸï¼

#### æ­¥éª¤ 3ï¼šä¸‹è½½é¡¹ç›®ä»£ç 

```bash
# ä½¿ç”¨ Git å…‹éš†ï¼ˆæ¨èï¼‰
git clone <é¡¹ç›®åœ°å€>
cd panda_factor

# æˆ–è€…ç›´æ¥ä¸‹è½½ ZIP æ–‡ä»¶è§£å‹
```

#### æ­¥éª¤ 4ï¼šå®‰è£… Python ä¾èµ–

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd panda_factor

# å®‰è£…ä¸»é¡¹ç›®ä¾èµ–
pip install -r requirements.txt

# å®‰è£…å„ä¸ªå­æ¨¡å—ï¼ˆé‡è¦ï¼ï¼‰
cd panda_common && pip install -e . && cd ..
cd panda_data && pip install -e . && cd ..
cd panda_data_hub && pip install -e . && cd ..
cd panda_factor && pip install -e . && cd ..
cd panda_factor_server && pip install -e . && cd ..
cd panda_llm && pip install -e . && cd ..
cd panda_web && pip install -e . && cd ..
```

**æˆ–è€…ä½¿ç”¨è„šæœ¬ï¼ˆå¦‚æœé¡¹ç›®æä¾›äº†ï¼‰ï¼š**

```bash
# ä¸€é”®å®‰è£…æ‰€æœ‰æ¨¡å—
./install.sh
```

#### æ­¥éª¤ 5ï¼šé…ç½® MongoDB è¿æ¥

1. **æ‰¾åˆ°é…ç½®æ–‡ä»¶**

    - è·¯å¾„ï¼š`panda_common/panda_common/config.yaml`

2. **ç¼–è¾‘é…ç½®æ–‡ä»¶**

    ```yaml
    # MongoDB é…ç½®
    MONGODB:
        HOST: "localhost" # MongoDB åœ°å€
        PORT: 27017 # MongoDB ç«¯å£ï¼ˆé»˜è®¤ 27017ï¼‰
        DATABASE: "panda" # æ•°æ®åº“åç§°
        USERNAME: "" # ç”¨æˆ·åï¼ˆå¦‚æœæœ‰ï¼‰
        PASSWORD: "" # å¯†ç ï¼ˆå¦‚æœæœ‰ï¼‰
    ```

3. **å¦‚æœä½¿ç”¨äº‘æ•°æ®åº“**
    - ä½¿ç”¨è¿æ¥å­—ç¬¦ä¸²æ ¼å¼ï¼š
    ```yaml
    MONGODB:
        CONNECTION_STRING: "mongodb://username:password@host:port/database"
    ```

#### æ­¥éª¤ 6ï¼šé…ç½®æ•°æ®æºï¼ˆå¯é€‰ï¼‰

å¦‚æœä½ è¦ä½¿ç”¨å¤–éƒ¨æ•°æ®æºï¼ˆTushareã€RiceQuant ç­‰ï¼‰ï¼Œéœ€è¦é…ç½®ï¼š

```yaml
# æ•°æ®æºé…ç½®
DATAHUBSOURCE: "tushare" # æˆ– "ricequant"ã€"xuntou"

# Tushare é…ç½®
TUSHARE:
    TOKEN: "ä½ çš„token"

# RiceQuant é…ç½®
MUSER: "ä½ çš„ç”¨æˆ·å"
MPASSWORD: "ä½ çš„å¯†ç "

# è¿…æŠ•é…ç½®
XTQUANT:
    # æ ¹æ®è¿…æŠ•æ–‡æ¡£é…ç½®
```

## âœ… éªŒè¯å®‰è£…

### æµ‹è¯• 1ï¼šæ£€æŸ¥ Python æ¨¡å—

```python
# æ‰“å¼€ Python äº¤äº’ç¯å¢ƒ
python

# æµ‹è¯•å¯¼å…¥
>>> import panda_common
>>> import panda_data
>>> import panda_factor
>>> print("æ‰€æœ‰æ¨¡å—å¯¼å…¥æˆåŠŸï¼")
```

### æµ‹è¯• 2ï¼šæµ‹è¯•æ•°æ®åº“è¿æ¥

```python
from panda_common.config import get_config
from panda_common.handlers.database_handler import DatabaseHandler

config = get_config()
db = DatabaseHandler(config)

# æµ‹è¯•è¿æ¥
try:
    # å°è¯•è·å–æ•°æ®åº“åˆ—è¡¨
    client = db.client
    db_list = client.list_database_names()
    print(f"æ•°æ®åº“è¿æ¥æˆåŠŸï¼å¯ç”¨æ•°æ®åº“ï¼š{db_list}")
except Exception as e:
    print(f"æ•°æ®åº“è¿æ¥å¤±è´¥ï¼š{e}")
```

### æµ‹è¯• 3ï¼šæµ‹è¯•æ•°æ®è¯»å–

```python
import panda_data

# åˆå§‹åŒ–
panda_data.init()

# å°è¯•è·å–æ•°æ®
try:
    symbols = panda_data.get_all_symbols()
    print(f"æˆåŠŸè·å– {len(symbols)} åªè‚¡ç¥¨ä»£ç ")
except Exception as e:
    print(f"æ•°æ®è¯»å–å¤±è´¥ï¼š{e}")
```

## ğŸ› å¸¸è§å®‰è£…é—®é¢˜

### é—®é¢˜ 1ï¼šPython æ¨¡å—å¯¼å…¥å¤±è´¥

**é”™è¯¯ä¿¡æ¯**ï¼š`ModuleNotFoundError: No module named 'panda_xxx'`

**è§£å†³æ–¹æ³•**ï¼š

```bash
# ç¡®ä¿å·²ç»å®‰è£…äº†æ‰€æœ‰å­æ¨¡å—
cd panda_common && pip install -e . && cd ..
# é‡å¤å…¶ä»–æ¨¡å—...
```

### é—®é¢˜ 2ï¼šMongoDB è¿æ¥å¤±è´¥

**é”™è¯¯ä¿¡æ¯**ï¼š`Connection refused` æˆ– `æ— æ³•è¿æ¥åˆ° MongoDB`

**è§£å†³æ–¹æ³•**ï¼š

1. æ£€æŸ¥ MongoDB æ˜¯å¦å¯åŠ¨ï¼š

    ```bash
    # Windows
    net start MongoDB

    # Mac/Linux
    brew services start mongodb-community
    # æˆ–
    sudo systemctl start mongod
    ```

2. æ£€æŸ¥é…ç½®æ–‡ä»¶ä¸­çš„åœ°å€å’Œç«¯å£æ˜¯å¦æ­£ç¡®

3. æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦é˜»æ­¢äº†è¿æ¥

### é—®é¢˜ 3ï¼šä¾èµ–åŒ…å®‰è£…å¤±è´¥

**é”™è¯¯ä¿¡æ¯**ï¼š`pip install` å¤±è´¥

**è§£å†³æ–¹æ³•**ï¼š

```bash
# å‡çº§ pip
pip install --upgrade pip

# ä½¿ç”¨å›½å†…é•œåƒæºï¼ˆå¦‚æœç½‘ç»œæ…¢ï¼‰
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### é—®é¢˜ 4ï¼šç«¯å£è¢«å ç”¨

**é”™è¯¯ä¿¡æ¯**ï¼š`Address already in use`

**è§£å†³æ–¹æ³•**ï¼š

-   æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–ç¨‹åºåœ¨ä½¿ç”¨ç›¸åŒç«¯å£
-   ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ç«¯å£å·
-   æˆ–è€…åœæ­¢å ç”¨ç«¯å£çš„ç¨‹åº

## ğŸ¯ å¼€å‘ç¯å¢ƒé…ç½®ï¼ˆå¯é€‰ï¼‰

### PyCharm é…ç½®

1. æ‰“å¼€ PyCharm
2. æ‰“å¼€é¡¹ç›®æ–‡ä»¶å¤¹
3. å³é”®ç‚¹å‡»ä»¥ä¸‹æ–‡ä»¶å¤¹ï¼Œé€‰æ‹© "Mark Directory as" â†’ "Sources Root"ï¼š
    - `panda_common`
    - `panda_data`
    - `panda_data_hub`
    - `panda_factor`
    - `panda_llm`
    - `panda_factor_server`

### VS Code / Cursor é…ç½®

1. æ‰“å¼€é¡¹ç›®æ–‡ä»¶å¤¹
2. åœ¨ç»ˆç«¯ä¸­è¿›å…¥å„ä¸ªå­æ¨¡å—ç›®å½•ï¼Œæ‰§è¡Œï¼š
    ```bash
    cd panda_common && pip install -e . && cd ..
    cd panda_data && pip install -e . && cd ..
    # ... å…¶ä»–æ¨¡å—
    ```

## ğŸ‰ å®‰è£…å®Œæˆï¼

æ­å–œä½ ï¼ç¯å¢ƒå·²ç»æ­å»ºå®Œæˆã€‚ç°åœ¨ä½ å¯ä»¥ï¼š

1. **ç»§ç»­å­¦ä¹ **ï¼š[ç¬¬ä¸€ä¸ªå› å­](./04-ç¬¬ä¸€ä¸ªå› å­.md) - åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªå› å­
2. **æˆ–è€…**ï¼šç›´æ¥å¼€å§‹ä½¿ç”¨ç³»ç»Ÿ

## ğŸ’¡ é‡è¦æç¤º

-   **ä¿å­˜é…ç½®**ï¼šä¿®æ”¹é…ç½®æ–‡ä»¶åï¼Œè®°å¾—é‡å¯ç›¸å…³æœåŠ¡
-   **å®šæœŸå¤‡ä»½**ï¼šå®šæœŸå¤‡ä»½ MongoDB æ•°æ®åº“
-   **æŸ¥çœ‹æ—¥å¿—**ï¼šé‡åˆ°é—®é¢˜å¯ä»¥æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ï¼ˆé€šå¸¸åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼‰

---

**å‡†å¤‡å¥½äº†å—ï¼Ÿè®©æˆ‘ä»¬å¼€å§‹åˆ›å»ºç¬¬ä¸€ä¸ªå› å­ï¼** ğŸš€
